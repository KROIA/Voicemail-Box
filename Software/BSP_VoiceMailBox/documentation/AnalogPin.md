# AnalogPin
This class can be used for easy access of analog input values provided by a ADC.
You can find a ready to run project [here](../../Demos/F469/F469_MultiExample/README.md).

---
## Content
- [Features](#features)
- [Setup](#setup)
- [Usage](#usage)

---
## Features
- Reading of the ADC value from one pin

Currently multiple pins from the same ADC are not supported.

---
## Setup
- Inside CubeMX, select a pin and configure it as **ADCX_INXX**.
- Start the code generation and open the code editor.
- Make sure the C++ application is setup in order to use this class
You can find the instructions on how to do so [here](CppFromC.md).
  
---
## Usage
In the `main.c` the ADC handle gets created. That is needed to pass to the constructor of the AnalogPin class. Since the C++ code can't be used directly in the **main.c**, another way of getting to the handle is needed.

#### Modify main.h and main.c
In the **main.h** create a get function that returns a pointer to the handle we want.
``` C
// main.h

// Function declaration
ADC_HandleTypeDef* getADC_handle();
```

``` C
// main.c

/* Private variables generated by CubeMX */
ADC_HandleTypeDef hadc1;

/* USER CODE BEGIN PV */
// Function implementation
ADC_HandleTypeDef* getADC_handle()
{
    // Return the pointer to the handle
    return &hadc1;
}
/* USER CODE END PV */
```


#### Inside the C++ Application
``` C++ 
// Application.cpp
#include "BSP_VoiceMailBox.hpp" // includes "peripherals/i2c.hpp"
#include "main.h" // Is needed to access the handle get function

// using a namespace globaly is not recommended for production
// but it simplyfies the example here
using namespace VoiceMailBox; 

// Create a I2C object and providing the handle from the main.c
AnalogPin analogPin(getADC_handle());

// Called periodically
void loop()
{
    println("Value 0: %d", analogPin.getValue());
    delay(100);
}
```

